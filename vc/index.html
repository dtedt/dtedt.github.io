<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fluid Kanban Board</title>
    <style>
        :root {
            --todo: rgba(255, 143, 0, 0.2);
            --now: rgba(255, 0, 0, 0.2);
            --progress: rgba(0, 100, 255, 0.2);
            --done: rgba(0, 200, 0, 0.2);
            
            --todo-solid: rgba(255, 143, 0, 0.8);
            --now-solid: rgba(255, 0, 0, 0.8);
            --progress-solid: rgba(0, 100, 255, 0.8);
            --done-solid: rgba(0, 200, 0, 0.8);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            height: 100vh;
            padding: 10px;
            overflow: hidden;
        }

        .kanban {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-auto-rows: minmax(100px, 1fr);
            gap: 10px;
            height: 100%;
            width: 100%;
        }

        .column {
            display: flex;
            flex-direction: column;
            border-radius: 8px;
            padding: 10px;
            transition: all 0.3s ease;
            min-height: 50px;
        }

        .column.empty {
            align-items: center;
            justify-content: center;
            min-height: 80px;
            cursor: pointer;
        }

        .column.empty::after {
            content: "+";
            font-size: 24px;
            font-weight: bold;
            color: rgba(0, 0, 0, 0.3);
        }

        .column-header {
            font-weight: bold;
            padding: 5px 0;
            margin-bottom: 10px;
            text-align: center;
            border-radius: 4px;
        }

        .todo .column-header {
            background-color: var(--todo-solid);
            color: white;
        }

        .now .column-header {
            background-color: var(--now-solid);
            color: white;
        }

        .progress .column-header {
            background-color: var(--progress-solid);
            color: white;
        }

        .done .column-header {
            background-color: var(--done-solid);
            color: white;
        }

        .todo {
            background-color: var(--todo);
        }

        .now {
            background-color: var(--now);
        }

        .progress {
            background-color: var(--progress);
        }

        .done {
            background-color: var(--done);
        }

        .tasks {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            flex-grow: 1;
        }

        .task {
            background-color: white;
            border-radius: 6px;
            padding: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            cursor: grab;
            transition: all 0.2s ease;
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
        }

        .task:active {
            cursor: grabbing;
        }

        .task.dragging {
            transform: scale(1.05) rotate(2deg);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 100;
        }

        .task-header {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .grab-handle {
            margin-right: 8px;
            cursor: grab;
            color: rgba(0, 0, 0, 0.3);
        }

        .task-title {
            font-weight: 500;
            flex-grow: 1;
        }

        .task-description {
            font-size: 12px;
            color: #555;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            flex-grow: 1;
        }

        .task.dragging .task-description {
            -webkit-line-clamp: unset;
        }

        .drop-target {
            outline: 2px dashed rgba(0, 0, 0, 0.3);
        }

        @media (max-width: 600px) {
            .kanban {
                grid-template-columns: 1fr;
                grid-auto-rows: minmax(80px, 1fr);
            }
            
            .column.empty {
                min-height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="kanban">
        <div class="column todo" data-status="todo">
            <div class="column-header">To Do</div>
            <div class="tasks">
                <div class="task" draggable="true" data-id="1">
                    <div class="task-header">
                        <span class="grab-handle">≡</span>
                        <span class="task-title">Design mockups</span>
                    </div>
                    <div class="task-description">Create high-fidelity mockups for the new dashboard interface</div>
                </div>
                <div class="task" draggable="true" data-id="2">
                    <div class="task-header">
                        <span class="grab-handle">≡</span>
                        <span class="task-title">User research</span>
                    </div>
                    <div class="task-description">Conduct interviews with 5 target users</div>
                </div>
            </div>
        </div>
        
        <div class="column now" data-status="now">
            <div class="column-header">NOW</div>
            <div class="tasks">
                <div class="task" draggable="true" data-id="3">
                    <div class="task-header">
                        <span class="grab-handle">≡</span>
                        <span class="task-title">API integration</span>
                    </div>
                    <div class="task-description">Connect frontend to the new payment API endpoints</div>
                </div>
            </div>
        </div>
        
        <div class="column progress" data-status="progress">
            <div class="column-header">In Progress</div>
            <div class="tasks">
                <div class="task" draggable="true" data-id="4">
                    <div class="task-header">
                        <span class="grab-handle">≡</span>
                        <span class="task-title">Database migration</span>
                    </div>
                    <div class="task-description">Migrate user data to the new schema with zero downtime</div>
                </div>
                <div class="task" draggable="true" data-id="5">
                    <div class="task-header">
                        <span class="grab-handle">≡</span>
                        <span class="task-title">Mobile responsive</span>
                    </div>
                    <div class="task-description">Fix layout issues on mobile devices</div>
                </div>
            </div>
        </div>
        
        <div class="column done" data-status="done">
            <div class="column-header">Done</div>
            <div class="tasks">
                <div class="task" draggable="true" data-id="6">
                    <div class="task-header">
                        <span class="grab-handle">≡</span>
                        <span class="task-title">Auth system</span>
                    </div>
                    <div class="task-description">Implement JWT authentication flow</div>
                </div>
                <div class="task" draggable="true" data-id="7">
                    <div class="task-header">
                        <span class="grab-handle">≡</span>
                        <span class="task-title">Onboarding flow</span>
                    </div>
                    <div class="task-description">Create step-by-step guide for new users</div>
                </div>
                <div class="task" draggable="true" data-id="8">
                    <div class="task-header">
                        <span class="grab-handle">≡</span>
                        <span class="task-title">Logo design</span>
                    </div>
                    <div class="task-description">Finalize new company branding</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const tasks = document.querySelectorAll('.task');
            const columns = document.querySelectorAll('.column');
            
            let draggedTask = null;
            
            // Update empty state of columns
            function updateEmptyStates() {
                columns.forEach(column => {
                    const tasksContainer = column.querySelector('.tasks');
                    const hasTasks = tasksContainer.children.length > 0;
                    
                    if (hasTasks) {
                        column.classList.remove('empty');
                    } else {
                        column.classList.add('empty');
                    }
                });
            }
            
            // Initialize
            updateEmptyStates();
            
            // Drag start
            tasks.forEach(task => {
                task.addEventListener('dragstart', (e) => {
                    draggedTask = task;
                    setTimeout(() => {
                        task.classList.add('dragging');
                    }, 0);
                    
                    e.dataTransfer.setData('text/plain', task.dataset.id);
                    e.dataTransfer.effectAllowed = 'move';
                });
                
                task.addEventListener('dragend', () => {
                    task.classList.remove('dragging');
                    draggedTask = null;
                });
            });
            
            // Drag over columns
            columns.forEach(column => {
                column.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.dataTransfer.dropEffect = 'move';
                    column.classList.add('drop-target');
                });
                
                column.addEventListener('dragleave', () => {
                    column.classList.remove('drop-target');
                });
                
                column.addEventListener('drop', (e) => {
                    e.preventDefault();
                    column.classList.remove('drop-target');
                    
                    if (draggedTask) {
                        const tasksContainer = column.querySelector('.tasks');
                        
                        // Check if we're dropping on an empty column
                        if (column.classList.contains('empty')) {
                            column.classList.remove('empty');
                            tasksContainer.appendChild(draggedTask);
                        } else {
                            // Find drop position (before or after existing tasks)
                            const afterElement = getDragAfterElement(tasksContainer, e.clientY);
                            
                            if (afterElement) {
                                tasksContainer.insertBefore(draggedTask, afterElement);
                            } else {
                                tasksContainer.appendChild(draggedTask);
                            }
                        }
                        
                        updateEmptyStates();
                    }
                });
            });
            
            // Helper function to determine drop position
            function getDragAfterElement(container, y) {
                const draggableElements = [...container.querySelectorAll('.task:not(.dragging)')];
                
                return draggableElements.reduce((closest, child) => {
                    const box = child.getBoundingClientRect();
                    const offset = y - box.top - box.height / 2;
                    
                    if (offset < 0 && offset > closest.offset) {
                        return { offset: offset, element: child };
                    } else {
                        return closest;
                    }
                }, { offset: Number.NEGATIVE_INFINITY }).element;
            }
            
            // Make columns responsive to window resize
            window.addEventListener('resize', () => {
                // The CSS grid handles most of it, but we might need to adjust task sizes
                updateEmptyStates();
            });
        });
    </script>
</body>
</html>